```json
[
"IF NOT WS-CONNECTED",
"    PERFORM DAL-CONNECT",
"    IF SQLCODE NOT EQUAL ZERO",
"        MOVE 'Y' TO LK-END-OF-FILE",
"        GOBACK",
"    END-IF",
"END-IF",
"IF NOT WS-CURSOR-OPEN",
"    EXEC SQL DECLARE C_PAR CURSOR FOR",
"        SELECT PARTICIPATION_ID_ACTIVITE, PARTICIPATION_ID_USER,",
"               PARTICIPATION_MODE_TRANSPORT",
"        FROM PARTICIPATION",
"        ORDER BY PARTICIPATION_ID_ACTIVITE, PARTICIPATION_ID_USER",
"    END-EXEC",
"    EXEC SQL OPEN C_PAR END-EXEC",
"    IF SQLCODE NOT EQUAL ZERO",
"        DISPLAY 'ERREUR OPEN: SQLCODE=' SQLCODE",
"        EXEC SQL ROLLBACK END-EXEC",
"        MOVE 'Y' TO LK-END-OF-FILE",
"        GOBACK",
"    END-IF",
"    SET WS-CURSOR-OPEN TO TRUE",
"END-IF",
"EXEC SQL FETCH C_PAR INTO :WS-PART-ID-ACTIVITE, :WS-PART-ID-USER,",
"    :WS-PART-MODE-TRANSPORT END-EXEC",
"EVALUATE SQLCODE",
"    WHEN 0",
"        MOVE WS-PART-ID-ACTIVITE TO PARTICIPATION-ID-ACTIVITE OF LK-PARTICIPATION",
"        MOVE WS-PART-ID-USER TO PARTICIPATION-ID-USER OF LK-PARTICIPATION",
"        MOVE WS-PART-MODE-TRANSPORT TO PARTICIPATION-MODE-TRANSPORT OF LK-PARTICIPATION",
"    WHEN 100",
"        MOVE 'Y' TO LK-END-OF-FILE",
"    WHEN OTHER",
"        DISPLAY 'ERREUR FETCH: SQLCODE=' SQLCODE",
"        EXEC SQL ROLLBACK END-EXEC",
"        MOVE 'Y' TO LK-END-OF-FILE",
"END-EVALUATE"
]
```