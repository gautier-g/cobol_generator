```json
[
"DISPLAY '=========================================='",
"DISPLAY 'DEBUT TRAITEMENT BATCH REPAS'",
"DISPLAY '=========================================='",
"MOVE 'READ' TO OPERATION",
"MOVE 'N' TO END-OF-FILE",
"CALL 'REPAS-DAL-DB' USING OPERATION, END-OF-FILE, REPAS",
"PERFORM UNTIL EOF-REACHED",
"    ADD 1 TO WS-COUNT-TOTAL",
"    PERFORM CALCULATE-REPAS",
"    MOVE 'SAVE' TO OPERATION",
"    CALL 'REPAS-DAL-DB' USING OPERATION, END-OF-FILE, REPAS",
"    CALL 'REPAS-BUSINESS' USING REPAS",
"    MOVE 'READ' TO OPERATION",
"    CALL 'REPAS-DAL-DB' USING OPERATION, END-OF-FILE, REPAS",
"END-PERFORM",
"MOVE 'END ' TO OPERATION",
"CALL 'REPAS-DAL-DB' USING OPERATION, END-OF-FILE, REPAS",
"DISPLAY '=========================================='",
"DISPLAY 'FIN TRAITEMENT BATCH REPAS'",
"DISPLAY 'Nombre repas traites: ' WS-COUNT-TOTAL",
"DISPLAY 'Repas en erreur: ' WS-COUNT-ERROR",
"DISPLAY '=========================================='",
"STOP RUN",
"CALCULATE-REPAS.",
"    IF REPAS-NBREPAS OF REPAS < 0",
"        MOVE 0 TO REPAS-NBREPAS OF REPAS",
"        ADD 1 TO WS-COUNT-ERROR",
"        DISPLAY 'ANOMALIE: Nombre repas invalide'",
"    END-IF"
]
```