```
       IDENTIFICATION DIVISION.
       PROGRAM-ID. EMPLOYEE-DAL-DB.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       REPOSITORY.
           FUNCTION ALL INTRINSIC.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
       01  SQLCA.
           05  SQLCAID     PIC X(8).
           05  SQLCABC     PIC S9(9) COMP-5.
           05  SQLCODE     PIC S9(9) COMP-5.
           05  SQLERRM.
               49  SQLERRML PIC S9(4) COMP-5.
               49  SQLERRMC PIC X(70).
           05  SQLERRP     PIC X(8).
           05  SQLERRD     OCCURS 6 TIMES PIC S9(9) COMP-5.
           05  SQLWARN.
               10  SQLWARN0 PIC X.
               10  SQLWARN1 PIC X.
               10  SQLWARN2 PIC X.
               10  SQLWARN3 PIC X.
               10  SQLWARN4 PIC X.
               10  SQLWARN5 PIC X.
               10  SQLWARN6 PIC X.
               10  SQLWARN7 PIC X.
           05  SQLSTATE    PIC X(5).

       01  WS-CONNECTED-FLAG      PIC X VALUE 'N'.
           88  WS-CONNECTED       VALUE 'Y'.
       01  WS-CURSOR-OPEN-FLAG    PIC X VALUE 'N'.
           88  WS-CURSOR-OPEN     VALUE 'Y'.

       LINKAGE SECTION.
       01  LK-OPERATION           PIC X(4).
       01  END-OF-FILE            PIC X.
       01  EMPLOYEE.
           05 EMP-ID              PIC 9(4).
           05 EMP-NAME            PIC A(30).
           05 SALARY-BRUT         PIC 9(6)V99.
           05 SALARY-NET          PIC 9(6)V99.

       PROCEDURE DIVISION USING LK-OPERATION END-OF-FILE EMPLOYEE.
       COUCHE-DAL.
           EVALUATE LK-OPERATION
               WHEN 'READ'
                   PERFORM DAL-READ
               WHEN 'SAVE'
                   PERFORM DAL-SAVE
               WHEN 'END '
                   PERFORM DAL-END
           END-EVALUATE
           .

       DAL-READ.
           IF NOT WS-CONNECTED
               EXEC SQL
                   CONNECT TO 'postgresql://localhost:5432/mydb' USER 'user' IDENTIFIED BY 'password'
               END-EXEC
               IF SQLCODE NOT = 0
                   MOVE 'Y' TO END-OF-FILE
                   EXIT PARAGRAPH
               END-IF
               SET WS-CONNECTED TO TRUE
           END-IF

           IF NOT WS-CURSOR-OPEN
               EXEC SQL
                   DECLARE C_EMP CURSOR FOR
                   SELECT EMP_ID, EMP_NAME, SALARY_BRUT, SALARY_NET
                   FROM EMPLOYEE
               END-EXEC
               EXEC SQL
                   OPEN C_EMP
               END-EXEC
               IF SQLCODE NOT = 0
                   MOVE 'Y' TO END-OF-FILE
                   EXIT PARAGRAPH
               END-IF
               SET WS-CURSOR-OPEN TO TRUE
           END-IF

           EXEC SQL
               FETCH C_EMP INTO
                   :EMP-ID,
                   :EMP-NAME,
                   :SALARY-BRUT,
                   :SALARY-NET
           END-EXEC
           IF SQLCODE NOT = 0
               MOVE 'Y' TO END-OF-FILE
           END-IF
           .

       DAL-SAVE.
           EXEC SQL
               UPDATE EMPLOYEE
               SET SALARY_NET = :SALARY-NET
               WHERE EMP_ID = :EMP-ID
           END-EXEC
           .

       DAL-END.
           IF WS-CURSOR-OPEN
               EXEC SQL
                   CLOSE C_EMP
               END-EXEC
               SET WS-CURSOR-OPEN TO FALSE
           END-IF

           EXEC SQL
               COMMIT
           END-EXEC

           IF WS-CONNECTED
               EXEC SQL
                   DISCONNECT ALL
               END-EXEC
               SET WS-CONNECTED TO FALSE
           END-IF
           .
```