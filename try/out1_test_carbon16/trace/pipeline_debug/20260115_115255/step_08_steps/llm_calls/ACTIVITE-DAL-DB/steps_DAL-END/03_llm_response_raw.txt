```json
[
"IF WS-CURSOR-OPEN-FLAG = 'Y'",
"EXEC SQL CLOSE C_ACT END-EXEC",
"IF SQLCODE NOT EQUAL ZERO",
"DISPLAY 'ERREUR CLOSE: SQLCODE=' SQLCODE",
"END-IF",
"MOVE 'N' TO WS-CURSOR-OPEN-FLAG",
"END-IF",
"IF WS-CONNECTED-FLAG = 'Y'",
"EXEC SQL COMMIT END-EXEC",
"IF SQLCODE NOT EQUAL ZERO",
"DISPLAY 'ERREUR COMMIT: SQLCODE=' SQLCODE",
"END-IF",
"DISPLAY 'Fermeture connexion'",
"EXEC SQL DISCONNECT ALL END-EXEC",
"IF SQLCODE NOT EQUAL ZERO",
"DISPLAY 'ERREUR DISCONNECT: SQLCODE=' SQLCODE",
"END-IF",
"MOVE 'N' TO WS-CONNECTED-FLAG",
"END-IF",
"GOBACK"
]
```