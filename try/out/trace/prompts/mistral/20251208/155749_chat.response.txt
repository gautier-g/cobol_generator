```
IDENTIFICATION DIVISION.
PROGRAM-ID. EMPLOYEE-DAL-DB.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-PC.
OBJECT-COMPUTER. IBM-PC.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  SQLCA.
    05  SQLCAID     PIC X(8).
    05  SQLCABC     PIC 9(9) COMP.
    05  SQLCODE     PIC S9(9) COMP.
    05  SQLERRM.
        49  SQLERRML PIC S9(4) COMP.
        49  SQLERRMC PIC X(70).
    05  SQLERRP     PIC X(8).
    05  SQLERRD     OCCURS 6 TIMES PIC S9(9) COMP.
    05  SQLWARN.
        10  SQLWARN0 PIC X.
        10  SQLWARN1 PIC X.
        10  SQLWARN2 PIC X.
        10  SQLWARN3 PIC X.
        10  SQLWARN4 PIC X.
        10  SQLWARN5 PIC X.
        10  SQLWARN6 PIC X.
        10  SQLWARN7 PIC X.
    05  SQLEXT      PIC X(8).

01  WS-CONNECTED          PIC X VALUE 'N'.
    88  CONNECTED         VALUE 'Y'.
    88  NOT-CONNECTED     VALUE 'N'.

01  WS-CURSOR-OPEN        PIC X VALUE 'N'.
    88  CURSOR-OPEN       VALUE 'Y'.
    88  CURSOR-CLOSED     VALUE 'N'.

LINKAGE SECTION.
01  LK-OPERATION          PIC X(4).
01  LK-END-OF-FILE        PIC X.
    88  EOF               VALUE 'Y'.
    88  NOT-EOF           VALUE 'N'.
01  LK-EMPLOYEE.
    05  LK-EMP-ID         PIC 9(4).
    05  LK-EMP-NAME       PIC A(30).
    05  LK-SALARY-BRUT    PIC 9(6)V99.
    05  LK-SALARY-NET     PIC 9(6)V99.

PROCEDURE DIVISION USING LK-OPERATION LK-END-OF-FILE LK-EMPLOYEE.
    EVALUATE LK-OPERATION
        WHEN 'READ'
            PERFORM DAL-READ
        WHEN 'SAVE'
            PERFORM DAL-SAVE
        WHEN 'END '
            PERFORM DAL-END
    END-EVALUATE
    GOBACK.

DAL-READ.
    PERFORM CONNECT-DB
    PERFORM OPEN-CURSOR
    EXEC SQL
        FETCH C_EMP INTO
            :LK-EMP-ID,
            :LK-EMP-NAME,
            :LK-SALARY-BRUT,
            :LK-SALARY-NET
    END-EXEC
    IF SQLCODE = 0
        MOVE 'N' TO LK-END-OF-FILE
    ELSE IF SQLCODE = 100
        MOVE 'Y' TO LK-END-OF-FILE
    ELSE
        MOVE 'Y' TO LK-END-OF-FILE
    END-IF.

DAL-SAVE.
    EXEC SQL
        UPDATE EMPLOYEE
        SET SALARY_NET = :LK-SALARY-NET
        WHERE EMP_ID = :LK-EMP-ID
    END-EXEC.

DAL-END.
    PERFORM CLOSE-CURSOR
    PERFORM DISCONNECT-DB.

CONNECT-DB.
    IF NOT-CONNECTED
        EXEC SQL
            CONNECT TO 'postgresql://localhost:5432/mydb' USER 'user' IDENTIFIED BY 'password'
        END-EXEC
        IF SQLCODE = 0
            MOVE 'Y' TO WS-CONNECTED
        ELSE
            MOVE 'Y' TO LK-END-OF-FILE
        END-IF
    END-IF.

DISCONNECT-DB.
    IF CONNECTED
        EXEC SQL
            COMMIT
        END-EXEC
        EXEC SQL
            DISCONNECT ALL
        END-EXEC
        MOVE 'N' TO WS-CONNECTED
    END-IF.

OPEN-CURSOR.
    IF NOT CURSOR-OPEN
        EXEC SQL
            DECLARE C_EMP CURSOR FOR
            SELECT EMP_ID, EMP_NAME, SALARY_BRUT, SALARY_NET
            FROM EMPLOYEE
        END-EXEC
        EXEC SQL
            OPEN C_EMP
        END-EXEC
        IF SQLCODE = 0
            MOVE 'Y' TO WS-CURSOR-OPEN
        ELSE
            MOVE 'Y' TO LK-END-OF-FILE
        END-IF
    END-IF.

CLOSE-CURSOR.
    IF CURSOR-OPEN
        EXEC SQL
            CLOSE C_EMP
        END-EXEC
        MOVE 'N' TO WS-CURSOR-OPEN
    END-IF.
```