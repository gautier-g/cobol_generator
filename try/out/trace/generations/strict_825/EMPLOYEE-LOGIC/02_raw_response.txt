IDENTIFICATION DIVISION.
PROGRAM-ID. EMPLOYEE-LOGIC.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 END-OF-FILE PIC X VALUE 'N'.
77 OPERATION PIC X(4).
01 EMPLOYEE.
    05 EMP-ID          PIC 9(4).
    05 EMP-NAME        PIC A(30).
    05 SALARY-BRUT     PIC 9(6)V99.
    05 SALARY-NET      PIC 9(6)V99.

PROCEDURE DIVISION.
MAIN-PROCESS.
    MOVE 'READ' TO OPERATION
    CALL 'EMPLOYEE-DAL-DB' USING OPERATION, END-OF-FILE, EMPLOYEE
    PERFORM UNTIL END-OF-FILE = 'Y'
        PERFORM CALCULATE-NET
        MOVE 'SAVE' TO OPERATION
        CALL 'EMPLOYEE-DAL-DB' USING OPERATION, END-OF-FILE, EMPLOYEE
        CALL 'EMPLOYEE-BUSINESS' USING EMPLOYEE
        MOVE 'READ' TO OPERATION
        CALL 'EMPLOYEE-DAL-DB' USING OPERATION, END-OF-FILE, EMPLOYEE
    END-PERFORM
    MOVE 'END ' TO OPERATION
    CALL 'EMPLOYEE-DAL-DB' USING OPERATION, END-OF-FILE, EMPLOYEE
    STOP RUN.

CALCULATE-NET.
    COMPUTE SALARY-NET ROUNDED = SALARY-BRUT * 0.7.